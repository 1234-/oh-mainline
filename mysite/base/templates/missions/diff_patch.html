{% extends 'base/one_column.html' %}

{% block body_id %}missions{% endblock body_id %}
{% block body_class %}{{ block.super }} beta {% endblock body_class %}

{% block title %}
Using diff and patch
{% endblock title %}

{% block main %}
<div class="module">
  <div class="body">
    <h1>Using diff and patch</h1>
    <p>When you make changes to open source software, you need an efficient way to show other people your changes so your changes can be reviewed or applied.  The diff and patch programs are often used for this purpose.  The diff program analyzes the files you give it and outputs the differences between them in a compact, human-and-machine-readable format, and the patch program reads diff output and uses it to transform a copy of the original files into the modified files.  So to show other people the changes, you can send them diff output, and they can use the patch program to apply your changes to their copy of the files.  When diff output is used in this way, the output itself is often called a patch or a diff.</p>
    <p>This mission consists of four parts: diffing individual files, patching individual files, diffing entire directory hierarchies, and patching entire directory hierarchies.</p>

    <h2>Patching individual files</h2>
    <p><a href="{% url mysite.missions.views.diffpatch_patchsingle_get_original_file %}">Here is a file</a> that contains a piece of code that could be implemented in a much better way.  Let's say that this file is part of a project you are working on, and somebody has come along, noticed the piece of code that could be improved, and <a href="{% url mysite.missions.views.diffpatch_patchsingle_get_patch %}">gave you a patch with the improved code</a>.</p>
    <p>In order to review the changes, you'll need to apply the patch to the file using the patch program, and your mission is to do that.</p>

    <form method="post" enctype="multipart/form-data" action="{% url mysite.missions.views.diffpatch_patchsingle_submit %}#patchsingle-form">
      <div class="form-row">
        <a name="patchsingle-form"></a>
        After you patch the file, upload it here:
  {% if patchsingle_success %}
    <div class="successmsg">
      <p><strong>You have successfully completed this part of the mission.</strong></p>
      <p>The file you uploaded has the correct contents.</p>
    </div>
  {% endif %}
        {% if patchsingle_error_message %}
        <ul class="errorlist"><li>{{ patchsingle_error_message }}</li></ul>
        {% endif %}
        {{ patchsingle_form.patched_file.errors }}
        <br style="clear: left;" />
        {{ patchsingle_form.patched_file }}
        <input type="submit" value="Upload" style="float: none;" />
        {% if patchsingle_done %}
        <br style="clear: left;" />
        <em>You have already completed this part of the mission.</em>
        {% endif %}
      </div>
    </form>
    <br style="clear: left;" />

    <h2>Diffing individual files</h2>
    <p>When you are submitting changes to a project, you will need to run diff to create a patch that you can submit.  <a href="{% url mysite.missions.views.diffpatch_diffsingle_get_original_file %}">Here is a text file which contains some simple instructions for modifying it.</a>  Once you have the file, you can make those changes in a text editor.  Then you can make a unified diff (the universally preferred flavor of diff output) of your changes.</p>
    <p>Large patches can be stored in files and attached to whatever medium you use to submit the patch, but since this patch is short, it can be included inline in the message.  So instead of uploading the patch in a file, your mission is to make your patch and copy and paste it into the box below.</p>

    <form method="post" action="{% url mysite.missions.views.diffpatch_diffsingle_submit %}#diffsingle-form">
      <div class="form-row">
        <a name="diffsingle-form"></a>
        Paste your patch here:
  {% if diffsingle_success %}
    <div class="successmsg">
      <p><strong>You have successfully completed this part of the mission.</strong></p>
      <p>The patch applies correctly and results in the correct file.</p>
    </div>
  {% endif %}
        {% if diffsingle_error_message %}
        <ul class="errorlist"><li>{{ diffsingle_error_message }}</li></ul>
        {% endif %}
        {{ diffsingle_form.diff.errors }}
        <br style="clear: left;" />
        {{ diffsingle_form.diff }}
        <input type="submit" value="Submit" style="float: none;" />
        {% if diffsingle_done %}
        <br style="clear: left;" />
        <em>You have already completed this part of the mission.</em>
        {% endif %}
      </div>
    </form>
    <br style="clear: left;" />

  </div>
</div>
{% endblock main %}
