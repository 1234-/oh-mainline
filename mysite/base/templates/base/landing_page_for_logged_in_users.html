{% extends 'base/base.html' %}
{% comment %}
# This file is part of OpenHatch.
# Copyright (C) 2011 Jack Grigg
# Copyright (C) 2011 Krzysztof Tarnowski (krzysztof.tarnowski@ymail.com)
# Copyright (C) 2010, 2011 OpenHatch, Inc.
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU Affero General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Affero General Public License for more details.
#
# You should have received a copy of the GNU Affero General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
{% endcomment %}

{% load cache %}
{% load base_extras %}
{% load profile_extras %}

{% block title %}
Home
{% endblock title %}

{% block body_id %}landing{% endblock body_id %}

{% block js_in_head %}
{{ block.super }}
<script type="text/javascript">
document.documentElement.className = 'javascript_is_enabled';
</script>
{% endblock %}

{% block content %}

     <div class='module' id='what_to_do'>
        
        <div class='body'>

            <div id='tabbed_container_of_big_links'>
                <ul class='tab_nav'>
                    <li class='ui-state-active'>
                        <a href='#for_contributors'>
                            <h4>Contribute to open source!</h4>
                        </a>
                    </li>
                    <li >
                        <a href='#for_project_maintainers'>
                            <h4>Attract contributors to your project!</h4>
                        </a>
                    </li>
                </ul>

                <div class='tab' id='for_contributors'>
                    <div class='tab_interior'>
                        
                        <div class='screenshot'>
                           <h3>Projects</h3>
                            <div class="body">
                                 <h5>I want to help with:</h5>
                                 {% if projects_i_wanna_help %} 
                                     <ul class="projects">
                                      {% for project in projects_i_wanna_help %}
                                          <li><a href='{{ project.get_url }}'>{{ project.display_name }}</a></li>
                                      {% endfor %}   
                                      </ul> 
                                 {% else %}
                                      <p>No projects listed yet.</p>
                                 {% endif %}
                                  
                               
                                 <h5>I have helped:</h5>
                                 {% if projects_i_helped %}
                                     <ul class="projects"> 
                                      {% for entry in projects_i_helped %}
                                          <li><a href="{{ entry.project.get_url }}">{{ entry.project.display_name }}</a></li>
                                      {% endfor %} 
                                     </ul>
                                 {% else %}
                                     <p>No projects listed yet.</p>
                                 {% endif %}
                                 <p class="rabbit_hole"><a href='{% url mysite.project.views.projects %}'>Find more projects to help with &raquo;</a></p>
                            </div>

                            <h3>Recommended bugs based on your profile  
                                <a class="feed" href="/+feeds/recbugs/{{ user.username }}/"><img src="{% version '/static/images/icons/feed-icon-14x14.png' %}" ></a>
                            </h3>
                            <div class="body">
                            
                            {% if nudge_tags %}
                                <p>Add tags to <a href='/profile/views/edit_info'>your profile</a> and get recommendations for nifty stuff to hack on.</p>
                            {% else %}
                                {% if recommended_bugs %}
                                <div id="bugs"> 
                                {% include "base/recommended_bugs_content.html" %}
                                </div>
                                {% else %}
                                <div id='bug-recommendations' class='hidden'></div>
                                <span id='ajax-loader-rec-bugs' class='ajax-loader-circle-txt-medium'>Loading bug recommendations...</span>
                                <div id='volunteer-opportunities' class='hidden'>
                                    <p>There are currently no bug recommendations available.</p>
                                    {% if recommended_bug_string2Query_objects.items %}
                                    <p>You can always search for bugs manually. For example:</p>
                                    <ul>
                                    {% for string, query in recommended_bug_string2Query_objects.items %}
                                        {% with query.get_or_create_cached_hit_count as count %}
                                        {% if count %}
                                        {# Don't show an example if no volunteer opportunities match it. #}
                                        <li><a href='/search?{{query.get_query_string}}'>{{string|safe}} ({{query.get_or_create_cached_hit_count}})</a></li>
                                        {% endif %}
                                        {% endwith %}
                                    {% endfor %}
                                    {% comment %}
                                    {% for category in popular_bug_categories %}
                                        <li><a href='{{ category.url }}'>{{ category.name }}</a></li>
                                    {% endfor %}
                                    {% endcomment %}
                                    </ul>
                                    {% endif %}
                                {% endif %}
                                
                                <p class="rabbit_hole"><a href='{% url mysite.search.views.fetch_bugs %}'>Find more recommendations and other opportunities &raquo;</a></p>
                            </div>
                            {% endif %}
                            </div>
                          

                         <div class='screenshot'>
                           <h3>Training missions</h3> 
                            <div class="body">
                                {% if nudge_missions %}
                                    <h5>Start learning:</h5>
                                    <p>Try our friendly, interactive training missions that teach you essential open source tools like diff and subversion.</p> 
                                {% else %}
                                    {% if completed_missions %}
                                        <ul class="missions">
                                            {% if completed_missions.tar or completed_missions.tar_extract %}
                                                {% if completed_missions.tar and completed_missions.tar_extract %}
                                                    <li>You have completed the <a href="{% url mysite.missions.tar.views.about %}">Tar mission.</a></li>
                                                {% else %}
                                                    <li style='list-style-image: url("http://openhatch.org/static/images/cross.gif");'>You have partially completed the <a href="{% url mysite.missions.tar.views.about %}">Tar mission.</a></li>
                                                {% endif %}
                                            {% endif %}
                                            {% if completed_missions.diffpatch_diffsingle or completed_missions.diffpatch_patchsingle or completed_missions.diffpatch_diffrecursive or completed_missions.diffpatch_patchrecursive %}
                                                {% if completed_missions.diffpatch_diffsingle and completed_missions.diffpatch_patchsingle and completed_missions.diffpatch_diffrecursive and completed_missions.diffpatch_patchrecursive %}
                                                    <li>You have completed the <a href="{% url mysite.missions.diffpatch.views.about %}">Diff and Patch mission.</a></li>
                                                {% else %}
                                                    <li style='list-style-image: url("http://openhatch.org/static/images/cross.gif");'>You have partially completed this <a href="{% url mysite.missions.diffpatch.views.about %}">Diff and Patch mission.</a></li>
                                                {% endif %}
                                            {% endif %}
                                            {% if completed_missions.svn_checkout or completed_missions.svn_diff or completed_missions.svn_commit %}
                                                {% if completed_missions.svn_checkout and completed_missions.svn_diff and completed_missions.svn_commit %}
                                                    <li>You have completed the <a href="{% url mysite.missions.svn.views.main_page %}">SVN mission.</a></li>
                                                {% else %}
                                                    <li style='list-style-image: url("http://openhatch.org/static/images/cross.gif");'>You have partially completed the <a href="{% url mysite.missions.svn.views.main_page %}">SVN mission.</a></li>
                                                {% endif %}
                                            {% endif %}
                                          {% if completed_missions.git_checkout or completed_missions.git_diff or completed_missions.git_rebase%}
                                                {% if completed_missions.git_checkout and completed_missions.git_diff and completed_missions.git_rebase%}
                                                    <li>You have completed the <a href="{% url mysite.missions.git.views.long_description %}">Git mission.</a></li>
                                                {% else %}
                                                    <li style='list-style-image: url("http://openhatch.org/static/images/cross.gif");'>You have partially completed the <a href="{% url mysite.missions.git.views.long_description %}">Git mission.</a></li>
                                        {% endif %}
                                    {% endif %}
                                        </ul>
                                    {% else %}
                                        <p>You haven't completed any missions yet.</p>
                                    {% endif %}
                                {% endif %}
                    
                            <p class="rabbit_hole"><a href="{% url mysite.missions.base.views.main_page %}">Learn more about missions &raquo;</a></p>
                            </div>

                           <h3>People</h3>
                            <div class="body">
                            {% with user.get_profile.get_collaborators_for_landing_page as collaborators %}
                            <div class='module' id='people'>
                                <div class='body'>
                                    <ul id='people-list'>
                                        {% if collaborators %}
                                        <h5>Collaborators:</h5>
                                            {% for person in collaborators %}
                                                {% include 'profile/person-summary-li.html' %}
                                            {% endfor %}
                                        {% else %}
                                        <h5>Some awesome people:</h5>
                                            {% for person in random_profiles %}
                                                {% include 'profile/person-summary-li.html' %}
                                            {% endfor %}
                                        {% endif %}
                                    </ul>
                                </div>
                            </div>
                            {% endwith %}
  
                            <p class="rabbit_hole"><a href="{% url mysite.profile.views.people %}">Find more awesome people &raquo;</a></p>
                            </div>

                            <h3>Syndicate your profile</h3>
                            <div class="body">
                            <p>Put your project list on your other web things.</p>
                            
                            <p class="rabbit_hole"><a href='{% url mysite.account.views.widget %}'>Get your widget &raquo;</a></p>
                            </div>
                        </div> 
                    </div>
                </div>

                <div class='tab  invisible_if_js' id='for_project_maintainers'>
                    <div class='tab_interior'>
                        <div class='screenshot'>
                            <a href='{% url mysite.project.views.projects %}' class='screenshot_image_wrapper' style='background-image: url({% version '/static/images/screenshots/project-page.png' %})'> </a>
                            <div class='caption'>
                                Let interested new contributors know where to begin on <a href='{% url mysite.project.views.projects %}'>
                                    your project's OpenHatch page</a>
                            </div>
                        </div>

                        <div class='screenshot'>
                            <a href='https://openhatch.org/wiki/Contacting_new_contributors' class='screenshot_image_wrapper' style='background-image: url({% version '/static/images/screenshots/wanna-help.png' %})'> </a>
                            <div class='caption'>
                                Tell people who have clicked your project's 'I want to help' button <a href="https://openhatch.org/wiki/Contacting_new_contributors">how they can contribute</a>
                            </div>
                        </div>

                        <div class='screenshot'>
                            <a href='http://openhatch.org/wiki/Bug_trackers' class='screenshot_image_wrapper' style='background-image: url({% version '/static/images/screenshots/opportunities.png' %})'> </a>
                            <div class='caption'>
                                <a href='http://openhatch.org/wiki/Bug_trackers'>Submit your project's bugtracker</a> so your bugs appear in the volunteer opportunities finder
                            </div>
                        </div>
                        
                    </div>
                </div>
            </div>

        </div>
    </div>
 
     <div class='module' id='recent_activity_feed'>
        <div class='head'>
            <h3>Recent activity</h3>
                 <a class='blog-feed' href="{% url oh_feed_url 'activity' %}">
                    <span class='alt-text'>RSS feed</span>
                 </a>
        </div>
        <div class='body'>
            <ul>
                {% for answer in recent_feed_items %}
                {% include answer.template_for_feed %}
                {% endfor %}
            </ul>
        </div>
    </div> 
    
    <div class='module' id='blog_feed'>
        <div class='head'>
            <h3>
                <a style='color: inherit;' href='/blog/'>
                    OpenHatch news
                </a>
            </h3> 
            <a class='blog-feed' title='RSS feed' href='/blog/feed/'>
                <span class='alt-text'>RSS feed</span>
            </a>
        </div>
        <div class='body'>
            <ul>
                {% for entry in entries %}
                <li>
                    <a style='font-weight: bold; line-height: 110%;' href="{{ entry.link }}">{{ entry.title }}</a>
                <div class='byline'>by {{ entry.author }} &bull; {{ entry.published_parsed|timesince_terse }} ago</div>
                <div class="entry">
                    {{ entry.unicode_text|truncatewords:15 }}
                </div>
                </li>
                {% endfor %}
            </ul>
            <p class="rabbit_hole"><a href='/blog/'>Get the whole blog &raquo;</a></p>
        </div>
    </div>
 
    
</div>
{% endblock content %}

{% block js %}
{{ block.super }}
<script type='text/javascript'>
$(function(){
        $('#people-list li').hoverClass('hover');
        $('#tabbed_container_of_big_links').tabs({
            cookie: {
                // keeps tab choice for one day
                expires: 1
            }
        });
        $('.invisible_if_js').removeClass('invisible_if_js');
});
</script>
<script src='static/js/base/landing_loggedin.js' type='text/javascript'></script>
{% endblock js %}
