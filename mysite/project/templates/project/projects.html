{% extends 'base/one_column.html' %}
{% load cache %}
{% load profile_extras %}

{% block title %}
Projects
{% endblock title %}

{% block body_id %}projects{% endblock %}

{% block css %}
{{ block.super }}
#big-project-list form p label{ text-align: left; display: block; width: 100%;}
#big-project-list form input[type='text'] { float: left; width: 20em; font-size: 1.5em; padding: 4px; }
#big-project-list form input[type='submit'] { float: left; font-weight: normal; font-size: 1.5em; padding: 4px 8px 3px 8px; position: relative; top: -1px; }
#big-project-list .note { margin-left: 2em; font-weight: normal; }
{% endblock css %}

{% block description_for_anonymous_users %}
<strong>Learn below</strong>
about the projects we index
{% endblock %}

{% block main %}
<div id='big-project-list' class='module'>
    <div class='head'>
        <h3>Projects on OpenHatch</h3>
    </div>
    <div class='module-content body'>
        <h4>
            <label for="search_q">Search for a project</label>
        </h4>
        <form method="POST" action="">
            <p>
                <input type="text" name="search_q" id="search_q" value="" />
                <input type="submit" value='Search'>
            </p>
        </form>
        {% cache 86400 projects %}{# cache for one day 86400 #}
        <h4>Projects with indexed bugs ({{ projects_with_bugs|length }})
        <span class='note'>These numbers just include bugs and contributors in our network.</span>
        </h4>
        <ul>
            {% for project in projects_with_bugs %}
                <li
            {% if forloop.counter0|divisibleby:"4" %}
            class='first-in-row'
            {% endif %}
            >
            <a href='{{ project.get_url }}'>
                {{ project.name|break_long_words|safe }} 
            </a>
            <div class='summary'>
                {% if project.get_open_bugs %}
                {{ project.get_open_bugs.count }} bug{{ project.get_open_bugs.count|pluralize }}<!--
                -->{% endif %}<!--
                -->{% if project.get_open_bugs and project.cached_contributor_count %},{% endif %}
                {% with project.cached_contributor_count as count %}
                {% if count %}
                {{ count }} contributor{{ count|pluralize }}
                {% endif %}
                {% endwith %}
            </div>
            </li>
            {% endfor %}
        </ul>
        <h4>Projects without bugs</h4>
        <ul>
            {% for project in cited_projects_lacking_bugs %}
            <li
            {% if forloop.counter0|divisibleby:"4" %}
            class='first-in-row'
            {% endif %}
            >
            <a href='{{ project.get_url }}'>
                {{ project.name|break_long_words|safe }} 
            </a>
            <div class='summary'>
                {% if project.get_open_bugs %}
                {{ project.get_open_bugs.count }} bug{{ project.get_open_bugs.count|pluralize }}<!--
                -->{% endif %}<!--
                -->{% if project.get_open_bugs and project.cached_contributor_count %},{% endif %}
                {% with project.cached_contributor_count as count %}
                {% if count %}
                {{ count }} contributor{{ count|pluralize }}
                {% endif %}
                {% endwith %}
            </div>
            </li>
            {% endfor %}
        </ul>
        {% endcache %}
    </div>
</div>
<style>
    #big-project-list li { width: 160px; float: left; margin: 0 50px 20px 0; }
    #big-project-list li a { font-size: 120%; }
    .summary { color: #444; margin-top: 5px; }
    .first-in-row { clear: left; }
    h4 { width: 100%; margin-top: 20px; margin-bottom: 10px; }
    h4:first-child { margin-top: 0px; }
</style>
{% endblock main %}
