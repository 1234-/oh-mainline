{% extends 'base/one_column.html' %}
{% load cache %}

{% block title %}
Projects
{% endblock title %}

{% block body_id %}projects{% endblock %}

{% block css %}
{{ block.super }}
#big-project-list form p label{ text-align: left; display: block; width: 100%;}
#big-project-list form input[type='text'] { float: left; width: 20em; font-size: 1.5em; padding: 4px; }
#big-project-list form input[type='submit'] { float: left; font-weight: normal; font-size: 1.5em; padding: 4px 8px 3px 8px; position: relative; top: -1px; }
#big-project-list .note { margin-left: 2em; font-weight: normal; }
{% endblock css %}

{% block description_for_anonymous_users %}
<strong>Learn below</strong>
about the projects we index
{% endblock %}

{% block main %}
<div id='big-project-list' class='module'>
    <div class='head'>
        <h3>Projects on OpenHatch</h3>
    </div>
    <div class='module-content body'>
        <h4>
            <label for="search_q">Search for a project</label>
        </h4>
        <form method="GET" action="" style='width: 100%; float: left; '>
                <input type="text" name="q" id="search_q" value="{{ query }}" />
                <input type="submit" value='Search'>
        </form>
        
        {% if matching_projects %}
            <p style='float: left; width: 100%; margin-top: 0; margin-bottom: 20px;'>
                You searched for &ldquo;{{ query }}&rdquo;.
                Here {{ matching_projects|pluralize:"is,are" }} your
                {{ matching_projects|length }} result{{ matching_projects|pluralize}}.
            </p>
        <ul>
            {% for project in matching_projects %}
                {% include 'project/project_list_item.html' %}
            {% endfor %}
        </ul>
        {% else %}
            {% if query %}
                <p>
                No matches for {{query}} :(
                </p>
                <p>
                    Help us out.
                <form method="POST" action="" style='width: 100%; float: left; '>
                        <input type="hidden" name="project_name" id="project_name" value="{{ query }}" />
                        <input type="submit" value='Create it'>
                </form>
                </p>
                
            {% endif %}
        {% endif %}

        {% if projects_with_bugs %}
        {% cache 86400 projects_with_bugs %}{# cache for one day 86400 #}
        <h4>Projects with indexed bugs ({{ projects_with_bugs|length }})
        <span class='note'>These numbers just include bugs and contributors in our network.</span>
        </h4>
        <ul>
            {% for project in projects_with_bugs %}
                {% include 'project/project_list_item.html' %}
            {% endfor %}
        </ul>
        {% endcache %}
        {% endif %}

        {% if cited_projects_lacking_bugs %}
        {% cache 86400 cited_projects_lacking_bugs %}
        <h4>Projects without bugs</h4>
        <ul>
            {% for project in cited_projects_lacking_bugs %}
                {% include 'project/project_list_item.html' %}
            {% endfor %}
        </ul>
        {% endcache %}
        {% endif %}

    </div>
</div>
<style>
    #big-project-list li { width: 160px; float: left; margin: 0 50px 20px 0; }
    #big-project-list li a { font-size: 120%; }
    .summary { color: #444; margin-top: 5px; }
    .first-in-row { clear: left; }
    h4 { width: 100%; margin-top: 20px; margin-bottom: 10px; }
    h4:first-child { margin-top: 0px; }
</style>
{% endblock main %}
